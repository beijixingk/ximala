<template>
  <div id="award">
    <div
      v-if="userView.length===0 || albumView.length===0 || trackView.length ===0 "
      class="page loading _dzUq">
      <div class="loading-body _TkUH">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 50 50"
          width="50"
          height="50"
          preserveAspectRatio="xMidYMid meet"
          style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px);"
        >
          <defs>
            <clipPath id="__lottie_element_170">
              <rect width="50" height="50" x="0" y="0" />
            </clipPath>
            <clipPath id="__lottie_element_172">
              <path d="M0,0 L100,0 L100,100 L0,100z" />
            </clipPath>
          </defs>
          <g clip-path="url(#__lottie_element_170)">
            <g
              clip-path="url(#__lottie_element_172)"
              transform="matrix(0.5,0,0,0.5,0,0)"
              opacity="1"
              style="display: block;"
            >
              <g
                transform="matrix(1,0,0,0.800000011920929,76.125,129.3050079345703)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.5939115285873413,91.125,109.11123657226562)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.20000000298023224,106.125,70.21900177001953)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.800000011920929,151.125,129.3050079345703)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.5939115285873413,136.125,109.11123657226562)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.20000000298023224,121.125,70.21900177001953)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
            </g>
          </g>
        </svg>
      </div>
      <p class="tc tip _dzUq">页面加载中...</p>
    </div>
    <div class="page" v-else>
      <section class="searchResult page _PLR">
        <header class="header page _PLR">
          <header class="xm-header__search _9FPi">
            <a class="logo-icon _9FPi" href="/">
              <svg width="70" height="15" class="icon" style="margin-left: 5px;">
                <use xlink:href="#icon-logo" />
                <svg id="icon-logo" viewBox="0 0 4778 1024">
                  <path
                    d="M1085.033113 217.006623c0 40.688742-6.781457 88.15894-94.940398 88.15894H0V210.225166h481.483444V135.629139H0V47.470199h481.483444V0h122.066225v47.470199H1085.033113v6.781457c0 40.688742-6.781457 81.377483-94.940398 81.377483H603.549669v67.81457l481.483444 13.562914z m0 434.013245c0 40.688742-6.781457 88.15894-94.940398 88.15894H0V644.238411h196.662252v-61.033113h-47.470199C67.81457 583.205298 6.781457 528.953642 6.781457 467.92053V352.635762h1071.470199v115.284768c0 67.81457-67.81457 115.284768-142.410596 115.284768h-81.377484v61.033113l230.569537 6.781457z m-6.781457 250.913907c0 67.81457-67.81457 115.284768-142.410596 115.284768H149.192053C67.81457 1017.218543 6.781457 962.966887 6.781457 901.933775v-115.284768h1071.470199v115.284768zM325.509934 644.238411h406.887417v-61.033113h-406.887417v61.033113zM162.754967 488.264901h759.523179c20.344371 0 33.907285-13.562914 33.907284-27.125828v-20.344371H135.629139v20.344371c0 20.344371 13.562914 27.125828 27.125828 27.125828z m0 440.794702h759.523179c20.344371 0 33.907285-13.562914 33.907284-27.125828V881.589404H135.629139v20.344371c0 13.562914 13.562914 27.125828 27.125828 27.125828zM4279.099338 339.072848h176.317881V162.754967h-176.317881V339.072848z m0 284.821192h176.317881V447.576159h-176.317881v176.317881z m0 284.821192h176.317881v-176.317881h-176.317881v176.317881zM4563.92053 0v61.033113H4747.019868V67.81457c0 47.470199-6.781457 101.721854-88.158941 101.721854h-88.15894V339.072848H4747.019868v6.781457c0 47.470199-6.781457 101.721854-88.158941 101.721854h-88.15894v176.317881H4747.019868v6.781457c0 47.470199-6.781457 101.721854-88.158941 101.721854h-88.15894v176.317881H4747.019868v6.781457c0 47.470199-6.781457 101.721854-88.158941 101.721854h-488.264901V0h108.503312v61.033113h176.317881V0h108.503311z m-535.7351 176.317881h-210.225165c-33.907285 0-61.033113-6.781457-81.377484-27.125828-27.125828-27.125828-33.907285-67.81457-33.907284-74.596027H4136.688742v773.086093c0 115.284768-33.907285 176.317881-196.662252 176.317881h-40.688742v-108.503311h40.688742c74.596026 0 81.377483-27.125828 81.377484-74.596027V522.172185h-135.62914c-169.536424 0-189.880795-94.940397-189.880794-176.31788V230.569536h108.503311v115.284769c0 54.251656 0 67.81457 81.377483 67.814569h135.62914V176.317881zM3980.715232 542.516556h20.344371l-169.536424 379.76159c-20.344371 54.251656-61.033113 81.377483-169.536424 81.377483l169.536424-372.980132c27.125828-74.596026 81.377483-88.15894 149.192053-88.158941zM1729.271523 840.900662c-33.907285-13.562914-74.596026-20.344371-115.284768-20.344371-189.880795 0-359.417219 128.847682-393.324503 155.97351v-142.410596c115.284768-81.377483 250.913907-128.847682 386.543046-128.847682 27.125828 0 47.470199 0 74.596027 6.781457 115.284768 13.562914 203.443709 67.81457 278.039735 115.284768 54.251656 33.907285 94.940397 61.033113 135.629139 61.033113 81.377483 0 81.377483-33.907285 81.377483-81.377484V644.238411c0-67.81457-20.344371-88.15894-94.940397-88.158941H1234.225166V189.880795H1356.291391v257.695364h739.178808c135.629139 0 210.225166 67.81457 210.225165 203.443709v183.099337c0 122.066225-74.596026 189.880795-196.662251 189.880795-94.940397 0-155.97351-47.470199-223.78808-94.940397-47.470199-33.907285-94.940397-67.81457-155.97351-88.158941zM1335.94702 115.284768c-94.940397 0-108.503311-81.377483-108.503311-108.503311V0h786.649006c176.317881 0 237.350993 61.033113 237.350994 237.350993v135.629139h-128.847683V264.476821c0-142.410596-20.344371-149.192053-149.192052-149.192053h-637.456954zM3092.344371 61.033113V27.125828h115.284768v27.125828H3526.357616c0 61.033113-54.251656 108.503311-115.284768 108.503311h-637.456954V61.033113h318.728477z m-495.046358 0V0h122.066225v840.900662c0 115.284768-67.81457 176.317881-189.880794 176.317881H2441.324503v-101.721854h67.81457c81.377483 0 88.15894-33.907285 88.15894-74.596027V556.07947H2441.324503c0-54.251656 47.470199-101.721854 108.503312-101.721854h47.470198V162.754967H2441.324503c0-54.251656 47.470199-101.721854 108.503312-101.721854h47.470198z m332.291391 806.993377l-108.503311-623.89404h6.781457c81.377483 0 128.847682 33.907285 142.410596 108.503312l67.814569 393.324503c6.781457 33.907285 0 67.81457-27.125828 94.940397-20.344371 13.562914-47.470199 27.125828-81.377483 27.125828z m366.198675 40.688742H3526.357616v6.781457c0 54.251656-54.251656 101.721854-115.284768 101.721854h-637.456954v-108.503311h325.509934c81.377483 0 128.847682-94.940397 162.754967-223.78808 0-13.562914 61.033113-332.291391 61.033112-339.072847 13.562914-74.596026 54.251656-108.503311 142.410596-108.503312h6.781457v6.781457L3390.728477 698.490066c-20.344371 94.940397-33.907285 142.410596-94.940398 210.225166z"
                    fill="#FA2800"
                  />
                </svg>
              </svg>
            </a>
            <a href="/search" class="searchInput _9FPi">
              <header class="searchWrapper _LhAj">
                <div class="formWrapper _LhAj">
                  <form class="inputWrapper _LhAj">
                    <i class="xm-icon icon-searchlight _LhAj"></i>
                    <p class="placeholder ellipsis inputValue _LhAj">{{keyword}}</p>
                    <i class="xm-icon icon-bg_delete _LhAj"></i>
                  </form>
                </div>
                <p class="_LhAj"></p>
              </header>
            </a>
            <a class="eG0ta _9FPi" to="iting://open">打开APP</a>
          </header>
          <section class="tabWrap _PLR">
            <div class="tabs _k_" style="height: 35px; line-height: 35px;">
              <div class="scrollWrapper _k_" style="display: flex; align-items: center;">
                <router-link
                  :to="'/searchdetail/searchall?keyword='+keyword"
                  active-class="select big"
                  class="item _k_"
                  style=" width: 25%; margin-left: 20px;"
                  @click.native="changeLeft(1)"
                >全部</router-link>
                <router-link
                  :to="'/searchdetail/searchzhuan?keyword='+keyword"
                  active-class="select big"
                  class="item _k_"
                  style="width: 25%;"
                  @click.native="changeLeft(2)"
                >专辑</router-link>
                <router-link
                  :to="'/searchdetail/searchsheng?keyword='+keyword"
                  active-class="select big"
                  class="item _k_"
                  style="width: 25%;"
                  @click.native="changeLeft(3)"
                >声音</router-link>
                <router-link
                  :to="'/searchdetail/searchzhu?keyword='+keyword"
                  active-class="select big"
                  class="item _k_"
                  style="width: 25%;"
                  @click.native="changeLeft(4)"
                >主播</router-link>
                <router-link
                  :to="'/searchdetail/searchlisten?keyword='+keyword"
                  active-class="select big"
                  class="item _k_"
                  style="width: 25%; margin-right: 20px;"
                  @click.native="changeLeft(5)"
                >
                  听单
                  <!-- <p class="underline _k_" style="width: 18px; display: block; left: 110px;"></p> -->
                </router-link>
                <!-- <p class="underline _k_" style="width: 18px; display: block; left: 33.3333px;"></p> -->
              </div>
            </div>
            <div
              v-if="types === 'searchzhu'"
              class="tabs _6AE"
              style="height: 40px; line-height: 40px;"
            >
              <a data-index="0" href="javascript: void(0)" class="item select _6AE">相关度</a>
              <a data-index="1" href="javascript: void(0)" class="item _6AE">最多声音</a>
              <a data-index="2" href="javascript: void(0)" class="item _6AE">最多粉丝</a>
            </div>
            <section v-if="types === 'searchzhuan'" class="content _TYJJ">
              <ul class="selectTypeList _TYJJ">
                <li data-index="0" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">分类</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
                <li data-index="1" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">排序方式</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
                <li data-index="2" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">是否付费</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
              </ul>
            </section>
            <section class="content _TYJJ" v-if="types === 'searchsheng'">
              <ul class="selectTypeList _TYJJ">
                <li data-index="0" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">排序方式</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
                <li data-index="1" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">是否付费</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
              </ul>
            </section>
            <section class="content _TYJJ" :class="{nones:specialnone}"  v-if="types === 'searchlisten'">
              <ul class="selectTypeList _TYJJ">
                <li data-index="0" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">分类</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
                <li data-index="1" class="selectType _TYJJ">
                  <span class="text ellipsis _TYJJ">排序方式</span>
                  <i class="xm-icon iconArrow _TYJJ icon-arrow-down"></i>
                </li>
              </ul>
            </section>
          </section>
        </header>
        <router-view :key="types" :bScroll="bScroll"></router-view>
      </section>
      <div class="xm-footer _px">
        <div class="footer-logo _px"></div>
        <div class="fo-txt _px">
          <a class="b2BlF footer-block _px" to="iting://open">
            <span class="open-app _px">打开APP，听更多声音</span>
            <i class="xm-icon footer-icon _px icon-album_btn_more"></i>
          </a>
        </div>
        <div class="copyright-txt _px">
          <p class="_px">Copyright © 2014-2019 www.ximalaya.com</p>
          <p class="_px">
            <span class="_px">lnc.ALL Rights Reserved</span>
            <i class="xm-icon footer-arrow _px icon-bottom_btn_up"></i>
          </p>
        </div>
        <div class="footer-nav _px">
          <a class="footer-nav-item _px">
            <span class="_px">全部分类</span>
          </a>
          <i class="footer-nav-line _px"></i>
          <a class="footer-nav-item _px">
            <span class="_px">海外版</span>
          </a>
          <i class="footer-nav-line _px"></i>
          <a class="footer-nav-item _px">
            <span class="_px">联系我们</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import { get } from "utils/http";
import BScroll from "better-scroll";
export default {
  data() {
    return {
      userView: "",
      albumView: "",
      trackView: "",
      specialView: "",
      others: [],
      keyword: "",
      types: "",
      index: 1,
      bScroll: "",
      specialnone:''
    };
  },
  async mounted() {
    this.bScroll = new BScroll("#award", {
      pullUpLoad: true,
      click: true,
      probeType: 2
    });
    let req = /[^\/](\w+)/g;
    this.types = this.$route.path.match(req)[1];
    // console.log(this.types);

    let message = this.$route.query.keyword;
    this.keyword = this.$route.query.keyword;
    // console.log();

    let result = await get({
      url: `/ajax/m-revision/page/search?kw=${message}&core=all&page=1&rows=5`
    });
    this.userView = result.data.userViews.users;
    this.albumView = result.data.albumViews.albums;
    this.trackView = result.data.trackViews.tracks;
    this.specialView = result.data.specialViews.specials;

    if(this.specialView.length===0){
      // console.log(111);
      this.specialnone = true
      
    }

    let other = await get({
      url: `/ajax/m-revision/page/search/recommendSearch?kw=${message}`
    });
    this.others = other.data;
    // console.log(this.others);
  },
  methods: {
    changeLeft(index) {
      console.log(index);
      if (index === 1) {
        this.index === 1;
        let req = /[^\/](\w+)/g;
        this.types = this.$route.path.match(req)[1];
      }
      if (index === 2) {
        // this.index === 1
        let req = /[^\/](\w+)/g;
        this.types = this.$route.path.match(req)[1];
      }
      if (index === 3) {
        // this.index === 1
        let req = /[^\/](\w+)/g;
        this.types = this.$route.path.match(req)[1];
      }
      if (index === 4) {
        // this.index === 4;
        let req = /[^\/](\w+)/g;
        this.types = this.$route.path.match(req)[1];
      }
      if (index === 5) {
        // this.index === 4;
        let req = /[^\/](\w+)/g;
        this.types = this.$route.path.match(req)[1];
      }
      console.log(this.types);
    }
  }
};
</script>
<style lang="stylus" scoped>
#award {
  max-height: 100%;
  background: #fff;
}

.nones {
  display: none;
}

.big {
  transform: translateY(-2px) scale(1.28571);
}
</style>