<template>
  <div>
    <div v-if="dataList.length===0 || cates.length===0" class="page loading _dzUq">
      <div class="loading-body _TkUH">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 50 50"
          width="50"
          height="50"
          preserveAspectRatio="xMidYMid meet"
          style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px);"
        >
          <defs>
            <clipPath id="__lottie_element_170">
              <rect width="50" height="50" x="0" y="0" />
            </clipPath>
            <clipPath id="__lottie_element_172">
              <path d="M0,0 L100,0 L100,100 L0,100z" />
            </clipPath>
          </defs>
          <g clip-path="url(#__lottie_element_170)">
            <g
              clip-path="url(#__lottie_element_172)"
              transform="matrix(0.5,0,0,0.5,0,0)"
              opacity="1"
              style="display: block;"
            >
              <g
                transform="matrix(1,0,0,0.800000011920929,76.125,129.3050079345703)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.5939115285873413,91.125,109.11123657226562)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.20000000298023224,106.125,70.21900177001953)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.800000011920929,151.125,129.3050079345703)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.5939115285873413,136.125,109.11123657226562)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
              <g
                transform="matrix(1,0,0,0.20000000298023224,121.125,70.21900177001953)"
                opacity="1"
                style="display: block;"
              >
                <g opacity="1" transform="matrix(1,0,0,1,-64.10900115966797,-99.52300262451172)">
                  <path
                    fill="rgb(248,100,66)"
                    fill-opacity="1"
                    d=" M2.890500068664551,-32.586002349853516 C2.890500068664551,-32.586002349853516 2.890500068664551,32.586002349853516 2.890500068664551,32.586002349853516 C2.890500068664551,34.18126678466797 1.5952669382095337,35.47650146484375 0,35.47650146484375 C0,35.47650146484375 0,35.47650146484375 0,35.47650146484375 C-1.5952669382095337,35.47650146484375 -2.890500068664551,34.18126678466797 -2.890500068664551,32.586002349853516 C-2.890500068664551,32.586002349853516 -2.890500068664551,-32.586002349853516 -2.890500068664551,-32.586002349853516 C-2.890500068664551,-34.18126678466797 -1.5952669382095337,-35.47650146484375 0,-35.47650146484375 C0,-35.47650146484375 0,-35.47650146484375 0,-35.47650146484375 C1.5952669382095337,-35.47650146484375 2.890500068664551,-34.18126678466797 2.890500068664551,-32.586002349853516z"
                  />
                </g>
              </g>
            </g>
          </g>
        </svg>
      </div>
      <p class="tc tip _dzUq">页面加载中...</p>
    </div>
    
    <Catewrap :cate="cates"></Catewrap>

    <bannerimg></bannerimg>
    <div
      class="xm-list list-view _rp3"
      style="padding: 15px;"
      v-for="value in dataList"
      :key="value.rankId"
    >
      <div class="list-view__header _rp3">
        <h2 class="list-view__title _rp3" style="font-size: 18px;">{{value.title}}</h2>
        <a
          class="more _kIb"
          href="/top/rise/all1"
          style="position: absolute; right: 14px; font-size: 12px; height: 25px; line-height: 25px; color: rgb(114, 114, 123); top: 0px;"
        >
          <i
            class="arrow _kIb"
            style="position: absolute; top: 8px; left: 30px; width: 6px; height: 6px; border-top: 2px solid rgb(114, 114, 123); border-right: 2px solid rgb(114, 114, 123); transform: rotate(45deg);"
          ></i>更多
        </a>
      </div>
      <ul class="list-view__body _rp3">
        <li
          @click="handleClick(value2.id)"
          class="list-view__item border _rp3"
          :datas="value.rankingContentInfoList.rankModuleInfoList"
          v-for="value2 in value.rankingContentInfoList.rankModuleInfoList"
          :key="value2.id"
        >
          <a>
            <div class="xm-album clearfix _8vVq">
              <div
                class="xm-album-cover rel cover cover _8vVq _9m"
                style="width: 70px; height: 70px;"
              >
                <img
                  class="cover-image _8vVq"
                  alt="习近平新时代中国特色社会主义思想学习纲要"
                  :src="'http://imagev2.xmcdn.com/'+value2.albumInfo.cover+'!op_type=3&amp;columns=144&amp;rows=144&amp;magick=webp'"
                />
                <div class="xm-album-cover__wrap _9m">
                  <div class="mask _9m"></div>
                  <div class="play-btn _9m"></div>
                </div>
              </div>
              <div class="content _8vVq">
                <h3
                  class="xm-album__title txt-1 ellipsis _8vVq"
                  style="color: rgb(51, 51, 51);"
                >{{value2.albumInfo.title}}</h3>
                <p class="xm-album__subtitle c9 ellipsis _8vVq">{{value2.albumInfo.customTitle}}</p>
                <div class="xm-album__info c9 _8vVq">
                  <span class="count _8vVq">
                    <i class="xm-icon icon-sound"></i>
                    &nbsp; {{value2.statCountInfo.trackCount}}
                  </span>
                  <span class="count _8vVq">
                    <i class="xm-icon icon-data"></i>&nbsp; {{value2.statCountInfo.playCount}}
                  </span>
                </div>
              </div>
            </div>
          </a>
        </li>
      </ul>
      <div class="list-view__footer _rp3"></div>
    </div>
    <!-- <div >加载中</div> -->
    
   

    <Xmfooter></Xmfooter>
  </div>
</template>
<script>
import bannerimg from "components/mainPage/Bannerimg";
import Catewrap from "components/mainPage/Catewrap";
import Xmfooter from "components/mainPage/Footer";
import BScroll from "better-scroll";

import { get } from "utils/http";

export default {
  data() {
    return {
    
      dataList: [],
      datas: "",
      cates: [],
      num:0
    };
  },
  components: {
    bannerimg,
    Catewrap,
    Xmfooter
  },
  methods: {
    handleClick(id) {
      this.$router.push(`/detail/${id}`);
      // console.log(1);
    }
  },
  async mounted() {
    let tabContent = await get({
      url: "/ajax/m-revision/page/index/queryIndexTabContent?moduleKey=tuijian"
    });
    this.cates = tabContent.data.moduleContent.tomatoes;

    // let result = await get({
    //   url: "/ajax/m-revision/page/index/queryIndexTabContent?moduleKey=tuijian"
    // });
    // console.log(result);
    this.dataList = tabContent.data.moduleContent.moduleRankDatas;

    for (var i = 0; i < this.dataList.length; i++) {
      for (var j = 0;j < this.dataList[i].rankingContentInfoList.rankModuleInfoList.length;j++) {
        this.num = this.dataList[i].rankingContentInfoList.rankModuleInfoList[
          j
        ].statCountInfo.playCount;
        if (this.num > 100000000) {
          this.dataList[i].rankingContentInfoList.rankModuleInfoList[
          j
        ].statCountInfo.playCount =
            Math.floor((this.num / 100000000) * 100) / 100 + "亿";
        } else {
          this.dataList[i].rankingContentInfoList.rankModuleInfoList[
          j
        ].statCountInfo.playCount =
            (this.num / 10000).toFixed(2) + "万";
        }
      }
    }
  }
};
</script>
<style lang="stylus" scoped>
.recommend {
  height: 100%;
  overflow: scroll;
}

.as {
  display: block;
  width: 100%;
  height: 100%;
}
.page.loading._dzUq
  top 0
</style>